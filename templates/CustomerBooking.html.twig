<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hotel Booking</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">
<div class="container py-4">

  <!-- Header -->
  <header class="mb-3 text-center bg-secondary text-white py-3 shadow rounded">
    <h1 class="display-5">Hotel Booking Portal</h1>
    <p class="mb-0">Welcome, {{ user.first_name }} {{ user.last_name }}</p>
  </header>

  <!-- Navigation -->
  <nav class="navbar navbar-expand bg-secondary mb-4">
    <div class="container d-flex justify-content-between">
      <form action="logout.php" method="POST" class="d-inline">
        <button type="submit" class="btn btn-link text-white nav-link-hover">Logout</button>
      </form>
    </div>
  </nav>

  <!-- Feedback -->
  {% if message %}
    <div class="alert alert-success text-center">{{ message }}</div>
  {% endif %}
  {% if error %}
    <div class="alert alert-danger text-center">{{ error }}</div>
  {% endif %}

  <!-- Booking Form -->
  <div class="card mb-4 shadow-sm">
    <div class="card-body">
      <h5 class="card-title">Book a Room</h5>
      <form method="POST" class="row g-3">

        <!-- Hotel Dropdown -->
        <div class="col-md-6">
          <label class="form-label">Select Hotel</label>
          <select name="Hotel_ID" class="form-select" onchange="this.form.submit()">
            <option value="">-- Select Hotel --</option>
            {% for hotel in hotels %}
              <option value="{{ hotel.Hotel_Id }}" {% if hotel.Hotel_Id == selectedHotel %}selected{% endif %}>
                {{ hotel.Hotel_Name }}
              </option>
            {% endfor %}
          </select>
        </div>

        <!-- Room Type Dropdown -->
        <div class="col-md-6">
          <label class="form-label">Room Type</label>
          <select name="Room_Type" class="form-select" onchange="this.form.submit()">
            <option value="">-- Select Type --</option>
            {% if selectedHotel %}
              {% for type in ['Standard','Deluxe','Suite'] %}
                <option value="{{ type }}" {% if type == selectedType %}selected{% endif %}>{{ type }}</option>
              {% endfor %}
            {% endif %}
          </select>
        </div>

        <!-- Room Number Dropdown -->
        {% if rooms %}
        <div class="col-md-6">
          <label class="form-label">Select Room</label>
          <select name="Room_ID" class="form-select">
            <option value="">-- Select Room --</option>
            {% for room in rooms %}
              <option value="{{ room.Room_Id }}">{{ room.Room_Number }}</option>
            {% endfor %}
          </select>
        </div>
        {% endif %}

        <!-- Check-in / Check-out -->
        <div class="col-md-3">
          <label class="form-label">Check-in</label>
          <input type="date" name="Check_in" class="form-control" required>
        </div>

        <div class="col-md-3">
          <label class="form-label">Check-out</label>
          <input type="date" name="Check_out" class="form-control" required>
        </div>

        <div class="col-12">
          <button type="submit" name="submitBookingRecord" class="btn btn-success">Book Room</button>
        </div>

      </form>
    </div>
  </div>

  <!-- My Bookings -->
  <h3 class="mb-3">My Bookings</h3>
  <div class="row g-3">
    {% if bookings|length > 0 %}
      {% for b in bookings %}
<div class="col-md-4">
  <div class="card shadow-sm h-100">
    {% if b.Hotel_Image %}
      <img src="{{ b.Hotel_Image|e }}" class="card-img-top" alt="{{ b.Hotel_Name|e }}" style="height:200px; object-fit:cover;">
    {% endif %}
    {% if b.weather %}
      <p class="mt-2 text-center">
        <img src="https://openweathermap.org/img/wn/{{ b.weather.icon }}.png" alt="Weather icon">
        {{ b.weather.temp }}Â°C - {{ b.weather.description|capitalize }}
      </p>
    {% endif %}
    <div class="card-body">
      <h5 class="card-title">{{ b.Hotel_Name }}</h5>
      <p class="card-text"><strong>Room:</strong> {{ b.Room_Number }} ({{ b.Room_Type }})</p>
      <p class="card-text"><strong>Check-in:</strong> {{ b.Check_in }}</p>
      <p class="card-text"><strong>Check-out:</strong> {{ b.Check_out }}</p>
    </div>
  </div>
</div>
{% endfor %}
    {% else %}
      <p class="text-center">No bookings yet.</p>
    {% endif %}
  </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
